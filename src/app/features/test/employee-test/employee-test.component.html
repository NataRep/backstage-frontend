<div class="test-container">
  <h2>ğŸ§ª EmployeeService Test Component</h2>

  <!-- Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ -->
  <div class="status" [class]="statusClass()">
    {{ statusMessage() }}
  </div>

  <!-- Ğ¤Ğ¾Ñ€Ğ¼Ğ° Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ/Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ -->
  <div class="form-section">
    <h3>ğŸ“ Create/Update Employee</h3>
    <div class="form-group">
      <label>ID (for setWithId):</label>
      <input [(ngModel)]="testEmployee.id" placeholder="Leave empty for auto-generate">
    </div>
    <div class="form-group">
      <label>Person ID:</label>
      <input [(ngModel)]="testEmployee.personId" placeholder="person123">
    </div>
    <div class="form-group">
      <label>Roles:</label>
      <div class="roles">
        <label *ngFor="let role of allRoles">
          <input type="checkbox" [value]="role" [checked]="testEmployee.roles.includes(role)"
            (change)="toggleRole(role, $event)">
          {{ role }}
        </label>
      </div>
    </div>
    <div class="form-group">
      <label>Active:</label>
      <input type="checkbox" [(ngModel)]="testEmployee.isActive">
    </div>

    <div class="button-group">
      <button (click)="testCreate()" [disabled]="loading">ğŸ¯ Create</button>
      <button (click)="testSetWithId()" [disabled]="loading">ğŸ’¾ Set With ID</button>
      <button (click)="testUpdate()" [disabled]="!currentEmployeeId() || loading">âœï¸ Update</button>
    </div>
  </div>

  <!-- ĞĞ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ñ‡Ñ‚ĞµĞ½Ğ¸Ñ -->
  <div class="read-section">
    <h3>ğŸ‘€ Read Operations</h3>
    <div class="button-group">
      <button (click)="testGetOne()" [disabled]="!currentEmployeeId() || loading">ğŸ” Get One</button>
      <button (click)="testGetAll()" [disabled]="loading">ğŸ“‹ GetAll</button>
      <button (click)="testQuery()" [disabled]="loading">ğŸ” Query Active</button>
    </div>

    <div class="employee-display" *ngIf="displayEmployee()">
      <h4>Current Employee:</h4>
      <pre>{{ displayEmployee() | json }}</pre>
    </div>

    <div class="employees-list" *ngIf="displayEmployees().length > 0">
      <h4>Employees List ({{ displayEmployees().length }}):</h4>
      <div *ngFor="let emp of displayEmployees()" class="employee-item">
        {{ emp.id }} - {{ emp.personId }} - {{ emp.roles.join(', ') }} - Active: {{ emp.isActive }}
      </div>
    </div>
  </div>

  <!-- Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ -->
  <div class="delete-section">
    <h3>ğŸ—‘ï¸ Delete Operations</h3>
    <div class="button-group">
      <button (click)="testDelete()" [disabled]="!currentEmployeeId() || loading" class="danger">
        ğŸ—‘ï¸ Delete Current
      </button>
      <button (click)="cleanupTestData()" [disabled]="loading" class="danger">
        ğŸ§¹ Cleanup All Test Data
      </button>
    </div>
  </div>

  <!-- Real-time Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸ -->
  <div class="subscription-section">
    <h3>ğŸ“¡ Real-time Subscriptions</h3>
    <div class="button-group">
      <button (click)="toggleSubscription('all')" [class.active]="subscriptions.all">
        {{ subscriptions.all ? 'ğŸ”´ Unsubscribe All' : 'ğŸŸ¢ Subscribe All' }}
      </button>
      <button (click)="toggleSubscription('one')" [class.active]="subscriptions.one" [disabled]="!currentEmployeeId()">
        {{ subscriptions.one ? 'ğŸ”´ Unsubscribe One' : 'ğŸŸ¢ Subscribe One' }}
      </button>
      <button (click)="toggleSubscription('changes')" [class.active]="subscriptions.changes">
        {{ subscriptions.changes ? 'ğŸ”´ Unsubscribe Changes' : 'ğŸŸ¢ Subscribe Changes' }}
      </button>
    </div>

    <div class="subscription-output">
      <div *ngIf="realtimeData.all.length > 0">
        <h4>All Subscription ({{ realtimeData.all.length }}):</h4>
        <div *ngFor="let emp of realtimeData.all" class="realtime-item">
          {{ emp.id }} - {{ emp.personId }}
        </div>
      </div>

      <div *ngIf="realtimeData.one">
        <h4>One Subscription:</h4>
        <pre>{{ realtimeData.one | json }}</pre>
      </div>

      <div *ngIf="realtimeData.changes.length > 0">
        <h4>Changes Subscription:</h4>
        <div *ngFor="let change of realtimeData.changes" class="change-item" [class]="change.type">
          {{ change.type }}: {{ change.doc.id }} - {{ change.doc.personId }}
        </div>
      </div>
    </div>
  </div>

  <!-- Ğ›Ğ¾Ğ³Ğ¸ -->
  <div class="logs-section">
    <h3>ğŸ“‹ Operation Logs</h3>
    <div class="logs">
      <div *ngFor="let log of logs()" [class]="log.type" class="log-entry">
        <span class="timestamp">{{ log.timestamp | date:'HH:mm:ss' }}</span>
        <span class="message">{{ log.message }}</span>
      </div>
    </div>
    <button (click)="clearLogs()" class="secondary">Clear Logs</button>
  </div>
</div>